<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Tamayan / ZebraSoft">
    <meta name="copyright" content="¬© 2025 Tamayan / ZebraSoft">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="icon" href="favicon.ico">
    <title>SLP-SlideLooperPuzzle</title>
    <link rel="stylesheet" href="style.css?v=1.0.0">
</head>
<body>
	<div class="main-header">
	    <div class="title-container" onclick="toggleMenu()">
	        <span class="title-text">SLP Slide Looper Puzzle v2.0</span>
	    </div>
	    <div class="header-side-right">
	        <button id="menu-dots" onclick="toggleMenu()" aria-label="Menu">&#8942;</button>
	    </div>
	</div>

    <div class="menu-panel">
		<button id="log-switch-btn" class="log-switch-btn active-rec" onclick="toggleLogSwitch()" title="Toggle Log Recording">
	        <span id="log-check-icon">‚òë</span> REC
	    </button>
        <button class="log-btn" onclick="toggleLogPanel()">LOG</button>

        <div class="mode-selector">
            <select id="mode-select" onchange="handleModeChange(this.value)">
                <option value="easy">Easy (2:2x2 / 4-Face)</option>
                <option value="mid" selected>Mid (2:3x3 / 9-Face)</option>
                <option value="hard">Hard (3:3x3 / 9-Face)</option>
                <option value="advance">Advance (2:4x4 / 16-Face)</option>
            </select>
        </div>
        
		<div class="action-group">
		    <input type="number" id="scramble-count" value="15" min="1" max="200">
		    <button id="shuffle-btn" onclick="shuffle()">Scramble</button>
		    <button id="reset-btn" onclick="initBoard()">Reset</button>
		</div>
    </div>
		<div id="media-controls" class="media-overlay-top">
		    <div class="m-group">
		        <button class="m-btn" onclick="replayStepBack()">‚óÄ Back</button>
		        <button class="m-btn stop" onclick="toggleReplayMode()">‚ñ† Exit</button>
		        <button class="m-btn" onclick="replayStepNext()">Next ‚ñ∂</button>
		    </div>
			<div class="replay-status">
			    <span id="current-move-display" style="font-weight:bold; margin-right:10px; min-width:50px; display:inline-block; text-align:center;">---</span>
			    STEP: <span id="replay-index">0</span> / <span id="replay-total">0</span>
			</div>
		</div>
	<div id="v2-media-uploader" class="media-overlay-top" style="display: none; border: 1px solid #0f0; background: rgba(0, 40, 0, 0.9); box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);">
		<div class="m-group">
			<input type="file" id="media-upload" accept="image/*,video/*" style="display: none;" onchange="handleMediaUpload(event)">
			<button class="m-btn" onclick="document.getElementById('media-upload').click()" style="background: #222; border: 1px solid #444;">üìÅ Load</button>
			<button class="m-btn stop" onclick="resetToColorMode()" style="background: #400; border: 1px solid #622;">üé® Reset</button>
		</div>
		<div class="replay-status" style="border-top: 1px solid rgba(0, 255, 0, 0.3); padding-top: 5px; color: #0f0; text-shadow: 0 0 5px #0f0;">
			V2 MODE: <span id="current-v2-mode">COLOR</span>
		</div>
	</div>
	<div id="log-overlay" class="overlay">
	    <div class="log-panel">
	        <div id="mode-display-neon" style="text-align: center; margin-bottom: 5px;">
	            <span id="current-mode-badge" style="color:#0f0; border:2px solid #0f0; padding:4px 15px; border-radius:20px; font-weight:bold; box-shadow:0 0 10px #0f0;">
	                MODE: <span id="mode-text">-- x --</span>
	            </span>
	        </div>

	        <div id="history-gimmick-display" style="display:flex; gap:15px; justify-content:center; padding:10px; background:#222; border-radius:5px; margin-bottom:5px; font-size:24px;">
	            <span class="g-icon" id="g-rotate" style="opacity:0.3;">üîÑ</span>
	            <span class="g-icon" id="g-spotlight" style="opacity:0.3;">üî¶</span>
	            <span class="g-icon" id="g-flash" style="opacity:0.3;">‚ö°</span>
	        </div>

	        <div id="log-error-msg" style="color:#ff4444; font-size:12px; height:18px; text-align:center; margin-bottom:5px;"></div>

	        <div class="log-section">
	            <label>Scramble Box (Question)</label>
	            <input type="text" id="scramble-input" placeholder="A-L1,B-R2,1-U2,3-D1..." >
	            <div class="log-controls">
					<button onclick="reproduceScramble()" title="Reproduce Scramble">üß© Apply</button>
                	<button onclick="triggerImport()" title="Import CSV">üì• Import</button>
                	<button onclick="saveCSV('scramble')" title="Save Scramble CSV">üíæ Save</button>
	            </div>
	        </div>

	        <div class="log-section">
	            <label>Solve Log (Live Answer)</label>
	            <input type="text" id="solve-log" readonly placeholder="Your solve log will appear here">
	            <div class="log-controls">
					<button onclick="copySolveToScramble()" title="Apply to Scramble">üìã Copy</button>
                	<button onclick="saveCSV('solve')" title="Save Solve Pattern">üíæ Save</button>
                	<button id="analyze-btn" onclick="startAnalyzeMode()" style="background:#d35400; flex: 2;" title="Analyze This Solve">üîç ANALYZE</button>	            </div>
	        </div>

	        <div class="log-section">
	            <label>History (Filtered by Mode)</label>
	            <div id="history-list" class="history-container" style="max-height:150px; overflow-y:auto; background:#111; border:1px solid #444; margin-bottom:5px;"></div>
	            <div class="log-controls">
					<button onclick="saveBackupCSV()" title="Backup History">üì§ Backup</button>
                	<button onclick="triggerRestore()" title="Restore History CSV">üì• Restore</button>	            </div>
	        </div>

	        <button class="close-btn" onclick="toggleLogPanel()">Close</button>
	        <input type="file" id="import-input" style="display:none" onchange="importCSV(event)">
	        <input type="file" id="restore-input" style="display:none" onchange="restoreHistory(event)">
	    </div>
	</div>

    <div class="content-wrapper">
        <div class="game-area">
            <div id="axis-top" class="axis-h"></div>
            <div id="axis-left" class="axis-v"></div>
            <div class="board-wrapper" id="board-wrapper">
				<div id="timer-frame" class="fx-frame"></div>
			    <div id="counter-frame" class="fx-frame"></div>
			    <div id="rotate-frame" class="fx-frame"></div>

                <div id="board" class="grid-container"></div>
                <div id="status-board" class="status-overlay">COMPLETE!</div>
				<div id="searchlight-overlay" class="searchlight-layer"></div>
            </div>
        </div>
        <div class="side-panel">
            <div class="preview-area">
                <div style="font-size: 12px; color: #aaa; margin-bottom: 5px;">TARGET VIEW</div>
                <div class="target-stack">
                    <div id="preview"></div>
                </div>
            </div>
			<div class="stats-display">
		        <div class="stat-item">
		            <span class="label">TIME</span>
		            <span id="timer-display">00:00.000</span>
		        </div>
		        <div class="stat-item">
		            <span class="label">MOVE</span>
		            <span id="counter-display">000</span>
		        </div>
	            <div class="action-icons">
	                <button class="icon-btn" onclick="copyCurrentToTarget()" title="Copy">
	                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
							<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
							<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
						</svg>
	                </button>
	                <button class="icon-btn" onclick="toggleTimer()" title="Timer">
	                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
							<circle cx="12" cy="12" r="10"></circle>
							<polyline points="12 6 12 12 16 14"></polyline>
						</svg>
	                </button>
					<button class="icon-btn" id="replay-trigger" onclick="toggleReplayMode()" title="Replay Mode">
					    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
					        <polygon points="5 3 19 12 5 21 5 3"></polygon>
					    </svg>
					</button>
						<button class="icon-btn" id="rotate-btn" onclick="startRotateCountdown()" title="Rotate">
							<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
								<path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
							</svg>
						</button>
	                </button>
	                <button class="icon-btn" onclick="toggleFlash()" title="Flash">
	                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5">
							<rect x="3" y="3" width="18" height="18" rx="2"/>
							<path d="M3 9h18M3 15h18M9 3v18M15 3v18"/>
							<rect x="10" y="4" width="4" height="4" fill="yellow" stroke="white" stroke-width="1"/>
						</svg>
	                </button>
	                <button class="icon-btn" onclick="toggleSearchlight()" title="Searchlight">
	                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5">
							<rect x="3" y="3" width="18" height="18" rx="2"/>
							<path d="M3 9h18M3 15h18M9 3v18M15 3v18"/>
							<circle cx="16" cy="12" r="5" stroke="white" stroke-width="2"/>
						</svg>
	                </button>
					<button class="icon-btn" id="v2-panel-toggle" onclick="toggleV2Panel()" title="Image Mode">
						<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
							<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
							<circle cx="8.5" cy="8.5" r="1.5"></circle>
							<polyline points="21 15 16 10 5 21"></polyline>
						</svg>
					</button>

					<button class="icon-btn" id="v2-video-toggle" onclick="toggleVideoPanel()" title="Video Mode">
						<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
							<rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
							<polygon points="10 8 15 11 10 14 10 8" fill="white"></polygon>
							<line x1="2" y1="21" x2="22" y2="21"></line>
							<line x1="7" y1="17" x2="7" y2="21"></line>
							<line x1="17" y1="17" x2="17" y2="21"></line>
						</svg>
					</button>
				</div>
		    </div>
        </div>
    </div>

    <div class="hint">
        Mobile: Drag (Std) / <b>Long Press</b> (Frame))<br>
        PC: Drag (Std) / <span class="key-indicator">Shift</span> (Frame) / <span class="key-indicator">Ctrl</span> (1-Cell)
    </div>
    <script src="script.js?v=1.0.0"></script>
</body>
</html>